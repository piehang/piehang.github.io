<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>密码页</title>
</head>
<body>
<h1>请输入密码</h1>
<input type="password" id="passwordInput" placeholder="密码">
<button id="submitBtn">提交</button>
<p id="error" style="color:red;"></p>

<script>
const CORRECT_HASH = '8c6976e5b5410415bde908bd4dee15dfb167a42f0ebfbd0c6b8db4d4605f4b04'; // admin

async function sha256(text){
    const encoder = new TextEncoder();
    const data = encoder.encode(text);
    const hashBuffer = await crypto.subtle.digest('SHA-256', data);
    const hashArray = Array.from(new Uint8Array(hashBuffer));
    return hashArray.map(b => b.toString(16).padStart(2,'0')).join('');
}

document.getElementById('submitBtn').addEventListener('click', async ()=>{
    const pw = document.getElementById('passwordInput').value.trim();
    const hash = await sha256(pw);
    if(hash === CORRECT_HASH){
        // 生成简单 token (Base64 编码)
        const token = btoa(pw + ':' + Date.now());
        // 跳转到 downloads.html 携带 token
        window.location.href = `downloads.html?token=${encodeURIComponent(token)}`;
    } else {
        document.getElementById('error').textContent = '密码错误';
    }
});
</script>
</body>
</html>