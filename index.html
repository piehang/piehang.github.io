<script>
const K="a94b4c2f184927cc";
const EP="1nK5vZjb+bKXWdEsGGXayA==";
const ED="0LnBvYFoOF2OkDbSAGr90mZwMsm63BEjeH0mdoSKe9A=";

async function aesKey(key){
  return crypto.subtle.importKey("raw", new TextEncoder().encode(key),"AES-CBC", false, ["encrypt","decrypt"]);
}

async function decryptAES(base64,key){
  const raw=Uint8Array.from(atob(base64),c=>c.charCodeAt(0));
  const iv=raw.slice(0,16);
  const data=raw.slice(16);
  const keyObj=await aesKey(key);
  const r=await crypto.subtle.decrypt({name:"AES-CBC",iv},keyObj,data);
  return new TextDecoder().decode(r);
}

document.getElementById("b").onclick=async()=>{
  try {
    const input=document.getElementById("p").value;
    const pwd=await decryptAES(EP,K);

    if(input!==pwd){
      document.getElementById("e").textContent="密码错误";
      return;
    }

    const target=await decryptAES(ED,K);
    location.href=target;

  } catch(e){
    document.getElementById("e").textContent="密码错误";
  }
};
</script>